#run integration tests (to be run on each target platform)
parameters:
  - name: 'platform'
    type: string

variables:
  commandline_tool_project: '$(source_directory)/commandline-tool/commandline-tool.csproj'
  valid_program: '$(test_directory)/data/ValidProgram.cosmos'

steps:
  - script: |
      echo Starting integration test on ${{ parameters.platform }} platform
      dotnet run -r ${{ parameters.platform }} --project $(commandline_tool_project) $(valid_program)
      echo End of integration test
      #workingDirectory:
      displayName: 'Integration tests: run on ${{ parameters.platform }}'
      failOnStderr: true
